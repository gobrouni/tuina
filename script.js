!function(){function e(){document.body.classList.remove("fonts-loading"),document.body.classList.add("fonts-loaded")}document.fonts&&document.fonts.ready?document.fonts.ready.then(e):setTimeout(e,1e3)}();const examSets=[["摩擦法","推法","拿法"],["摩擦法","按法","拿法"],["摩擦法","揉法","抖法"],["摩擦法","撥法","抖法"],["摩擦法","推法","搖法"],["滾法","推法","拿法"],["滾法","按法","拿法"],["滾法","揉法","抖法"],["滾法","撥法","搖法"],["滾法","按法","搖法"],["推法","拿法","拍擊法"],["按法","抖法","拍擊法"],["揉法","抖法","拍擊法"],["撥法","搖法","拍擊法"],["揉法","搖法","拍擊法"]],viewIntro=document.getElementById("view-intro"),viewResult=document.getElementById("view-result"),btnDraw=document.getElementById("btn-draw"),btnBack=document.getElementById("btn-back"),resultTitle=document.getElementById("result-title"),cardSingle=document.getElementById("card-single"),cardExam=document.getElementById("card-exam"),cardContainer=document.querySelector(".card-display"),modalOverlay=document.getElementById("detail-modal"),btnCloseModal=document.getElementById("btn-close-modal"),modalTitle=document.getElementById("modal-title"),modalEng=document.getElementById("modal-eng"),modalDesc=document.getElementById("modal-desc"),modalBody=document.querySelector(".modal-body");let currentMode="exam";function init(){cardSingle.addEventListener("click",()=>{currentMode="single",updateRadio("single"),startDraw()}),cardExam.addEventListener("click",()=>{currentMode="exam",updateRadio("exam"),startDraw()}),btnDraw.addEventListener("click",draw),btnBack.addEventListener("click",showIntro),btnCloseModal&&btnCloseModal.addEventListener("click",hideModal),modalOverlay&&modalOverlay.addEventListener("click",e=>{e.target===modalOverlay&&hideModal()});document.querySelectorAll(".chip").forEach(e=>{e.addEventListener("click",()=>{const n=e.textContent.trim(),t=techniques.find(e=>e.name===n);t&&showModal(t)})})}function updateRadio(e){document.getElementsByName("practice_mode").forEach(n=>{n.value===e&&(n.checked=!0)})}function startDraw(){draw(),showResult()}function draw(){let e=[];if("single"===currentMode){e=[...techniques].sort(()=>.5-Math.random()).slice(0,1),resultTitle.textContent="單題練習模式"}else{const n=Math.floor(Math.random()*examSets.length);e=examSets[n].map(e=>techniques.find(n=>n.name===e)),resultTitle.textContent=`模擬考模式 (第 ${n+1} 組)`}renderCards(e)}function renderCards(e){cardContainer.innerHTML="",e.forEach((e,n)=>{const t=document.createElement("div");t.className="technique-card",t.addEventListener("click",function(){showModal(e)}),t.innerHTML=`\n            <div class="card-header-area">\n                ${"exam"===currentMode?`<span class="badge">第 ${n+1} 題</span>`:""}\n                <h3 class="card-title">${e.name}</h3>\n            </div>\n            \n            <div class="reveal-hint">\n                <span class="material-symbols-outlined" style="font-size: 1.25rem;">visibility</span>\n                <span>查看詳細說明</span>\n            </div>\n        `,cardContainer.appendChild(t)}),window.scrollTo({top:0,behavior:"smooth"})}function showResult(){viewIntro.classList.add("hidden"),viewResult.classList.remove("hidden")}function showIntro(){viewResult.classList.add("hidden"),viewIntro.classList.remove("hidden"),cardContainer.innerHTML=""}function showModal(e){modalTitle.textContent=e.name,e.details?modalDesc.innerHTML=`\n            <div class="detail-section">\n                <h4>操作定義</h4>\n                <ul>\n                    ${e.details.definition.map(e=>`<li>${e}</li>`).join("")}\n                </ul>\n            </div>\n            \n            <div class="detail-section">\n                <h4>操作要領</h4>\n                <ul>\n                    ${e.details.essentials.map(e=>`<li>${e}</li>`).join("")}\n                </ul>\n            </div>\n            \n            <div class="detail-section">\n                <h4>適用部位</h4>\n                <ul>\n                    ${e.details.areas.map(e=>`<li>${e}</li>`).join("")}\n                </ul>\n            </div>\n            \n            <div class="detail-section">\n                <h4>調理效果</h4>\n                <ul>\n                    ${e.details.effects.map(e=>`<li>${e}</li>`).join("")}\n                </ul>\n            </div>\n        `:modalDesc.innerHTML=`<p>${e.desc}</p>`,modalOverlay.classList.remove("hidden"),document.body.style.overflow="hidden",setTimeout(()=>{modalBody&&(modalBody.style.scrollBehavior="auto",modalBody.scrollTop=0,modalBody.style.scrollBehavior="")},0)}function hideModal(){modalOverlay.classList.add("hidden"),document.body.style.overflow=""}document.addEventListener("DOMContentLoaded",init);